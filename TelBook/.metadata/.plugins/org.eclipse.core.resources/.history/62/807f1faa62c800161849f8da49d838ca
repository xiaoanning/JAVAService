package dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.util.List;

import util.JDBCUtil;
import entity.Person;

public class PersonDaoImplement implements PersonDao
{

	public Integer insertPerson(Person p) 
	{
		Connection con = null ;
		PreparedStatement ps = null ;
		int result = 0 ;
		
		try
		{
			con = JDBCUtil.getConnection() ;
			
			ps = con.prepareStatement("insert into person1 vaues(?,?,?,?,?,?,?)");
			ps.setInt(1,p.getId());
			ps.setString(2, p.getName());
			ps.setString(3, p.getMobile());
			ps.setString(4, p.getTelphone());
			ps.setString(5, p.getEmail());
			ps.setString(6, p.getCity());
			ps.setDate(7, p.getBirthday());
			result = ps.executeUpdate();
			
			return result ;
		} catch (Exception e)
		{

			e.printStackTrace();
			throw new RuntimeException("≤Â»Î ß∞‹");
		}finally
		{
			try 
			{
				JDBCUtil.close(null,ps,null);
			} catch (Exception e) 
			{
				e.printStackTrace();
			}
		}
		
	}

	public void updatePerson(Person p) 
	{
		Connection con = null ;
		PreparedStatement ps = null ;
		
		try
		{
			con = JDBCUtil.getConnection();
			ps = con.prepareStatement("update person1 set name = ?, mobile = ? , telphone = ? ,email = ? , city = ? , birthday = ? where id = ?");
			ps.setString(1, p.getName());
			ps.setString(2, p.getMobile());
			ps.setString(3, p.getTelphone());
			ps.setString(4, p.getEmail());
			ps.setString(5, p.getCity());
			ps.setDate(6, p.getBirthday());
			ps.setInt(7, p.getId());
			ps.executeUpdate();
			
		}catch(Exception e)
		{
			e.printStackTrace();
		}finally
		{
			try
			{
				JDBCUtil.close(null, ps, null);
			}catch(Exception e)
			{
				e.printStackTrace();
			}
		}
		
	}

	public void deletePerson(Integer id) {
		// TODO Auto-generated method stub
		
	}

	public Person queryPersonById(Integer id) {
		// TODO Auto-generated method stub
		return null;
	}

	public List<Person> queryAllPersons() {
		// TODO Auto-generated method stub
		return null;
	}

	public List<Person> queryPersonsByName(String name) {
		// TODO Auto-generated method stub
		return null;
	}

	public List<Person> queryPersonsByMobile(String mobile) {
		// TODO Auto-generated method stub
		return null;
	}

	public List<Person> queryPersonsByMonth() {
		// TODO Auto-generated method stub
		return null;
	}

}


